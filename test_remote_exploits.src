import_code("library/basic.inc.src")
import_code("library/metasploit.inc.src")

metaxploit = _load_metasploit

if params.len < 3 or params[0] == "--help" then
	exit "test_remote_exploits [IP] [Port] [ExploitFile] [[additionalParam]]"
end if

remote_lib = _load_remote_lib(metaxploit, params[0], params[1].to_int)

if not remote_lib then
    exit "Failed to load remote library"
end if

exploits = _load_exploits(params[2])

additionalParam = ""
if params.len > 3 then
    additionalParam = params[3]
end if

_test_exploits(remote_lib, exploits, additionalParam)