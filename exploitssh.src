import_code("/home/bigd/programs/init.inc.src")
import_code("/home/bigd/programs/user.inc.src")
import_code("/home/bigd/programs/basic.inc.src")

if params.len < 4 or params[0] == "-h" or params[0] == "--help" then exit("<b>Usage: "+program_path.split("/")[-1]+" [ip_address] [port] [memory_address] [string]</b>")
// use 0 for port if router

exploits = [[params[2], params[3]]]

res = _exploit_remote(exploits)

if params.len == 5 and params[4] == "--init" then
    uname = user_input("Type username you see above: ")
    _init_base_commands(res, uname)
end if

res.start_terminal
