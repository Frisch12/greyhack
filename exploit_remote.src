import_code("library/basic.inc.src")
import_code("library/metasploit.inc.src")

metaxploit = _load_metasploit

if params.len < 4 or params[0] == "--help" then
	exit "test_remote_exploits [IP] [Port] [ExploitFile] [ExploitType] [[AdditionalParam]]"
end if

remote_lib = _load_remote_lib(metaxploit, params[0], params[1].to_int)

if not remote_lib then
    exit "Failed to load remote library"
end if

exploits = _load_exploits(params[2])

additionalParam = ""
if params.len > 4 then
    additionalParam = params[4]
end if

_exploit_lib(remote_lib, exploits, params[3], additionalParam)
