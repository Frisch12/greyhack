import_code("/home/bigd/programs/init.inc.src")
import_code("/home/bigd/programs/basic.inc.src")
import_code("/home/bigd/programs/file.inc.src")

if params.len < 4 or params[0] == "-h" or params[0] == "--help" then exit("<b>Usage: "+program_path.split("/")[-1]+" [ip_address] [port] [memory_address] [string] [[param]]</b>")

if (params.len == 4) then
    exploits = [[params[2], params[3]]]
else if (params.len == 5) then
    exploits = [[params[2], params[3], params[4]]]
end if

res = _exploit_remote(exploits)

_print_content = function (root, path)
    file = _find_file(root, path)
    if not file or file.is_binary or file.is_folder then
        print("Failed to get file " + path)
    else
        print(file.get_content)
    end if 
end function

root = res.File("/")

_print_content(root, "/etc/passwd")

uir = user_input("Search homes: ")
if uir == "y" or uir == "Y" then
    home_folder = _find_folder(root, "/home")
    subs = home_folder.get_folders
    for folder in subs
        _print_content(folder, "/Config/Bank.txt")
        _print_content(folder, "/Config/Mail.txt")
    end for
end if 