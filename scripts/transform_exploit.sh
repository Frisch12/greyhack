#!/bin/bash

if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <filename>"
    exit 1
fi

filename=$1

exploits=()
current_address=""

while IFS= read -r line; do
    if [[ $line == "0x"* ]]; then
        current_address=$(echo $line | cut -d' ' -f1)
    elif [[ $line == *"Unsafe check"* ]]; then
        exploit=$(echo $line | cut -d'.' -f1 | rev | cut -d' ' -f1 | rev)
        exploits+=("$current_address$exploit:none")
    fi
done < $filename

echo "Exploits found:"
output_file="${filename}"
echo "" > $output_file
for exploit in "${exploits[@]}"; do
    echo $exploit
    echo $exploit >> $output_file
done