import_code("library/basic.inc.src")
import_code("library/metasploit.inc.src")

metaxploit = _load_metasploit

if params.len < 3 or params[0] == "--help" then
	exit "exploit [Library] [ExploitFile] [ExploitType] [[AdditionalParam]]"
end if

remote_lib = _load_metalib(metaxploit, params[0])

if not remote_lib then
    exit "Failed to load remote library"
end if

exploits = _load_exploits(params[1])

additionalParam = ""
if params.len > 3 then
    additionalParam = params[3]
end if

_exploit_lib(remote_lib, exploits, params[2], additionalParam)
